# TongIS集成KAFKA

**名词解释**

**1、消息中间件：包含传统消息中间件，如TLQ，MQ，ActiveMQ**。也包括新一代消息中间件，如KAFKA（TLQ-D），PULSAR，ROCKETMQ。

# **1** **产品背景及市场分析**

## **1.1** **产品背景概述**

### 国外产品

Oracle ESB，IBM IB，都集成有消息中间件。其中IB是深度集成消息中间件，OSB支持消息中间件功能。

新一代集成产品，Oracle Integration，内嵌支持事件，是消息的高级封装；IBM AppConnect，是IB的升级，基于消息进行流转。

### 国内产品

华为ROMAConnect支持消息中间件功能，支持监控管理

普元在东方锅炉标书里写到需要消息中间件功能，强调集成能力，以及监控管理能力

KLINK未看到内嵌消息中间件的描述

## **1.2** **目标市场概述**

- 对数据有可靠性要求的数据分发场景，如工云智慧

- 与普元，ROMAConnect等产品在关于消息管理方面具备竞争优势

- 长期目标，对于信创需要替换IBM AppConnect，从功能角度可以替换（无法简单升级），深圳地铁，

目标市场，是集成的某个场景，需要用到消息中间件，而不是直接卖消息中间件，与TLQ-X差异定位。

内嵌的kafka不考虑支持大规模的消息处理的场景，仅用于集成场景下的消息处理（约束topic数量最大600），大规模的消息处理需要单独购买TLQ-X.

## **1.3 技术概述**

### 1.3.1 产品主要功能

#### 场景化

1.  处理流程：以数据库到RESTFUL API举例。

从数据库读取数据，发送到kafka保存，然后将数据发送到RESTFUL API，成功后，对kafka中的消息进行确认。失败，则不确认，下次会重复收到失败消息并重新处理。

无法判断是否成功或者失败的数据，进入人工处理通道。

2.  用户使用设计

通过场景化的界面设计，用户看不到KAFKA的存在，只需要选择读取的数据库类型及相关信息，需要发送的目的端类型（如RESTFUL API）及相关信息即可。

3.  数据库数据分发

数据库到RESTFUL API：

数据库到SOAP

数据库到数据库

4.  消息中间件数据分发（目前已经支持）

消息中间件到RESTFUL API

消息中间件到SOAP

消息中间件到数据库

#### 主题管理

主题授权

主题创建

主题删除

#### 安全管理

用户管理

#### 监控

集群监控

Broker监控

Topic监控

消费者监控

消息监控--生产者的消息监控，消费者的消息监控

### 1.3.2 实现

在第一步（这里是数据库连接）处产生eventid，后续所有的逻辑都带着eventid，监控时，根据eventid产生一个完整的流程。

![](_media\TongIS集成kafka\实现.png)

### 1.3.3 消息中间件选择

主流的消息中间件包括，kafka，pulsar，rocketmq。

kafka生态完整，成熟度高。

IBM和Oracle，选择kafka作为流处理中间件。

kafka主要约束在于不能在服务器端进行过滤等加工处理操作，只能在客户端自行处理。

**选择kafka。**

# **2** **产品现状分析**

## **2.1** **公司现有产品现状**

目前有企业服务总线类产品TongESB 7.0，以及消息中间件产品TLQ。

将二者整合，满足某些集成类场景需要消息中间件的情况。

## **2.3** **产品典型应用场景**

企业市场，涉及到可靠数据分发场景

医疗市场，涉及到可靠数据分发场景

长期的，随着这套逻辑成熟，涉及IBM AppConnect，可以考虑替换

## **2.4** **存在的问题分析**

\[用户需求和问题，销售反馈问题，售后支持问题，产品本身问题等\]

kafka比较复杂，能够运维需要积累。

# **3** **产品竞争分析**

老产品增加新功能，不涉及

# **4 总体策略与建议**

\[确定我们要进入的市场以及采取的策略。策略可以从以下方面考虑：

产品策略和行动计划：老产品完善

定价策略和行动计划：老产品价格调整方案

- 标准版，TongIS功能

- 企业版，TongIS + kafka + CDC，保证可靠性的数据分发, 支持CDC方式抽取数据

# **5 路标**

## **5.1** **产品版本路标图**

\[用坐标图画出整个产品线版本路标规划。纵轴为路标，横轴为上市时间。\]

1.  监控管理kafka，新增kafka触发器，通过手工编排流程做到可靠数据分发

优势：顺着目前的思路继续，工作量可控

劣势：用户需要编排两个集成流，用起来麻烦，统计监控看到的是两个。考虑通过eventid等逻辑串起来

监听一个topic需要一个线程，能够监控的topic数量受限。

各类资源需求：（人员、设备、外部采购需求等）

TongIS团队完成。包含kafka管理功能，以及kafka与tongis整合相关功能

## **5.2** **详细路标**

1.  一级版本上市时间及主要特性

| 版本     | V2.0.4                                                       |
| -------- | ------------------------------------------------------------ |
| 启动时间 | 待定，预期7月开始                                            |
| 上市时间 | 待定                                                         |
| 主要特性 | 管理kafka  监控kafka  编排的流程与kafka打通                  |
| 客户价值 | 保证数据可靠性，满足关键业务对数据不重不丢的要求             |
| 市场卖点 | 支持可靠的数据分发。  为替换IBM AppConnect提供可能性。       |
| 主要不足 | TongIS以API为中心，数据分发作为补充。目前实际存在两个流程，通过eventid打通，有些绕，用户直接编排流程不够直观 |

2.  关键技术研究规划

kafka学习掌握，常见问题分析解决

kafka优化

TongIS与kafka整合设计
